; ==============================================================================
; КОНФИГУРАЦИЯ ПУЛА PHP-FPM (www)
; Особенности:
;   - Работа через UNIX-сокет для максимальной производительности
;   - Оптимизировано для Docker и Alpine Linux
; ==============================================================================

; Название пула процессов
[www]

; Адрес прослушивания. UNIX-сокет быстрее, чем TCP, так как исключает накладные расходы на сеть
listen = /var/run/php/php-fpm.sock

; Пользователь и группа для выполнения PHP-скриптов
user = www-data
group = www-data

; Права доступа к сокету.
; Владельцем является www-data, а Nginx должен иметь права на чтение/запись (см. nginx.Dockerfile)
listen.owner = www-data
listen.group = www-data
listen.mode = 0660

; Режим управления процессами (dynamic - создаются по необходимости)
pm = dynamic

; Максимальное количество процессов (ограничиваем для экономии памяти в учебном проекте)
pm.max_children = 5

; Количество процессов при старте
pm.start_servers = 2

; Минимальное количество ожидающих процессов
pm.min_spare_servers = 1

; Максимальное количество ожидающих процессов
pm.max_spare_servers = 3

; Сохраняем переменные окружения из Docker (важно для работы БД и Xdebug)
clear_env = no