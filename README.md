# PHP-Httpd-Socket: –£—á–µ–±–Ω—ã–π —Å—Ç–µ–∫ –Ω–∞ Docker

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è PHP –∏ –µ–≥–æ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã. –°—Ç–µ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **UNIX-—Å–æ–∫–µ—Ç—ã** –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É Apache (Httpd) –∏ PHP-FPM, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –±—ã—Å—Ç—Ä–µ–µ –∏ –±–ª–∏–∂–µ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º.

> **–í–∞–∂–Ω–æ:** –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ (Production).

---

## üöÄ –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ (–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

–°—Ç–µ–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ `docker-compose.yml`:

1.  **PHP-FPM 8.4** (`php-httpd-socket`):
    *   –ë–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ Alpine Linux.
    *   –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —á–µ—Ä–µ–∑ UNIX-—Å–æ–∫–µ—Ç `/var/run/php/php-fpm.sock`.
    *   –£–∫–æ–º–ø–ª–µ–∫—Ç–æ–≤–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: PDO, MySQLi, GD, MBString, Zip –∏ –¥—Ä.
    *   –í–∫–ª—é—á–∞–µ—Ç **Xdebug 3** (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ `.env`) –∏ **Composer** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.
2.  **Apache (Httpd)** (`httpd-socket`):
    *   –í—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞.
    *   –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ PHP —á–µ—Ä–µ–∑ –æ–±—â–∏–π UNIX-—Å–æ–∫–µ—Ç.
    *   –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É *Single Entry Point* (–≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ `index.php`).
3.  **MySQL 8.4** (`mysql-httpd-socket`):
    *   –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
    *   –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω–æ–º —Ç–æ–º–µ `mysql-data`.
4.  **phpMyAdmin** (`phpmyadmin-httpd-socket`):
    *   –£–¥–æ–±–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö MySQL.
    *   –î–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø–æ—Ä—Ç—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ `.env` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é [http://localhost:8080](http://localhost:8080)).

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
php-httpd-socket/
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ httpd/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conf/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ httpd.conf      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Apache (Httpd)
‚îÇ   ‚îú‚îÄ‚îÄ php/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ php.ini             # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PHP (–æ—à–∏–±–∫–∏, –ª–∏–º–∏—Ç—ã, Xdebug)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ www.conf            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–ª–∞ PHP-FPM (UNIX-—Å–æ–∫–µ—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ httpd.Dockerfile        # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ Apache
‚îÇ   ‚îî‚îÄ‚îÄ php.Dockerfile          # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞ PHP-FPM
‚îú‚îÄ‚îÄ public/                     # –ö–æ—Ä–µ–Ω—å —Å–∞–π—Ç–∞ (DocumentRoot)
‚îÇ   ‚îú‚îÄ‚îÄ index.php               # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ phpinfo.php             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ PHP
‚îú‚îÄ‚îÄ docker-compose.yml          # –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ docker-compose.xdebug.yml   # –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Xdebug
‚îú‚îÄ‚îÄ Makefile                    # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–º
‚îú‚îÄ‚îÄ .env.example                # –û–±—Ä–∞–∑–µ—Ü –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md                   # –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞
```

---

## üõ† –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã **Docker** –∏ **Docker Compose**.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:
```bash
cp .env.example .env
```
*–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫ –ë–î –∏–ª–∏ –ø–æ—Ä—Ç—ã, –µ—Å–ª–∏ –æ–Ω–∏ –∑–∞–Ω—è—Ç—ã.*

### 3. –ó–∞–ø—É—Å–∫
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Makefile` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:
```bash
make up
```
*–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∫–æ–Ω—Ñ–∏–≥–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.*

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞
*   **–°–∞–π—Ç:** [http://localhost](http://localhost) (–∏–ª–∏ –ø–æ—Ä—Ç `HTTPD_PORT` –∏–∑ `.env`)
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PMA):** [http://localhost:8080](http://localhost:8080) (–∏–ª–∏ –ø–æ—Ä—Ç `PHPMYADMIN_PORT` –∏–∑ `.env`)
*   **PHP Info:** [http://localhost/phpinfo.php](http://localhost/phpinfo.php)

---

## üêû –û—Ç–ª–∞–¥–∫–∞ —Å Xdebug

Xdebug —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–∞—Å—Å–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ. –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Ä–µ–∂–∏–º, —Ö–æ—Å—Ç) –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ —Ñ–∞–π–ª `.env`.

1.  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä. `XDEBUG_MODE=debug`).
2.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å—Ç–µ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
    ```bash
    make xdebug-up
    ```
3.  –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∞—à—É IDE (–Ω–∞–ø—Ä–∏–º–µ—Ä, PhpStorm –∏–ª–∏ VS Code) –Ω–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞ **9003**.
4.  –î–ª—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `make xdebug-down`.

---

## ‚å®Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (Makefile)

*   `make up` / `make down` ‚Äî –∑–∞–ø—É—Å–∫ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞.
*   `make restart` / `make rebuild` ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–ª–∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞.
*   `make info` ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ø–æ—Ä—Ç—ã –∏ —Å—Ç–∞—Ç—É—Å —Å—Ä–µ–¥—ã.
*   `make status` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
*   `make test` ‚Äî –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ HTTP-—Å–µ—Ä–≤–∏—Å–æ–≤.
*   `make logs` ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
*   `make shell-php` / `make shell-mysql` ‚Äî –¥–æ—Å—Ç—É–ø –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É PHP –∏–ª–∏ –∫–æ–Ω—Å–æ–ª–∏ MySQL.
*   `make composer-install` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞.
*   `make clean-all` ‚Äî –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö –ë–î).

---

## üéì –ü–æ—á–µ–º—É UNIX-—Å–æ–∫–µ—Ç?

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ Docker-—Ç—É—Ç–æ—Ä–∏–∞–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (`127.0.0.1:9000`). –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º UNIX-—Å–æ–∫–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ:
1.  **–°–∫–æ—Ä–æ—Å—Ç—å:** –ú–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ —è–¥—Ä–∞.
2.  **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –î–æ—Å—Ç—É–ø –∫ —Å–æ–∫–µ—Ç—É –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–∞–≤–∞–º–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.
3.  **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å:** –ò–º–µ–Ω–Ω–æ —Ç–∞–∫ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.

–°–≤—è–∑—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ –æ–±—â–∏–π Docker-—Ç–æ–º `unix-socket`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –æ–±–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
